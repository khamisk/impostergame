<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clash Royale Imposter Game</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <!-- Main Menu Screen -->
    <div id="mainMenu" class="screen active">
        <div class="container">
            <h1 class="game-title">üéÆ GUESS THE IMPOSTER</h1>
            <p class="subtitle">Clash Royale Edition</p>
            <p class="disclaimer">This project has no affiliation with Supercell.</p>

            <div class="menu-buttons">
                <button id="createLobbyBtn" class="btn btn-primary">Create Lobby</button>
                <button id="joinByCodeBtn" class="btn btn-primary">Join by Code</button>
                <button id="howToPlayBtn" class="btn btn-info">How to Play</button>
                <button id="refreshLobbiesBtn" class="btn btn-secondary">Refresh Lobbies</button>
            </div>

            <div class="lobbies-section">
                <h2>Available Lobbies</h2>
                <div id="lobbiesList" class="lobbies-list">
                    <p class="no-lobbies">No public lobbies available. Create one!</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Create Lobby Modal -->
    <div id="createLobbyModal" class="modal">
        <div class="modal-content">
            <h2>Create Lobby</h2>
            <form id="createLobbyForm">
                <div class="form-group">
                    <label for="lobbyNameInput">Lobby Name:</label>
                    <input type="text" id="lobbyNameInput" maxlength="30" required>
                </div>
                <div class="form-group">
                    <label for="usernameCreateInput">Your Username:</label>
                    <input type="text" id="usernameCreateInput" maxlength="20" required>
                </div>
                <div class="form-group">
                    <label for="passwordInput">Password (optional):</label>
                    <input type="password" id="passwordInput" maxlength="20">
                </div>
                <div class="form-group">
                    <label for="maxPlayersInput">Max Players:</label>
                    <select id="maxPlayersInput">
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5" selected>5</option>
                    </select>
                </div>
                <div class="modal-buttons">
                    <button type="submit" class="btn btn-primary">Create</button>
                    <button type="button" id="cancelCreateBtn" class="btn btn-secondary">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Join Lobby Modal -->
    <div id="joinLobbyModal" class="modal">
        <div class="modal-content">
            <h2>Join Lobby</h2>
            <p id="joinLobbyName" class="lobby-name-display"></p>
            <form id="joinLobbyForm">
                <input type="hidden" id="joinLobbyCode">
                <div class="form-group">
                    <label for="usernameJoinInput">Your Username:</label>
                    <input type="text" id="usernameJoinInput" maxlength="20" required>
                </div>
                <div class="form-group" id="joinPasswordGroup" style="display: none;">
                    <label for="joinPasswordInput">Password:</label>
                    <input type="password" id="joinPasswordInput" maxlength="20">
                </div>
                <div class="modal-buttons">
                    <button type="submit" class="btn btn-primary">Join</button>
                    <button type="button" id="cancelJoinBtn" class="btn btn-secondary">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Join by Code Modal -->
    <div id="joinByCodeModal" class="modal">
        <div class="modal-content">
            <h2>Join by Code</h2>
            <form id="joinByCodeForm">
                <div class="form-group">
                    <label for="lobbyCodeInput">Lobby Code:</label>
                    <input type="text" id="lobbyCodeInput" maxlength="6" placeholder="Enter 6-character code" required>
                </div>
                <div class="form-group">
                    <label for="usernameCodeInput">Your Username:</label>
                    <input type="text" id="usernameCodeInput" maxlength="20" required>
                </div>
                <div class="form-group" id="codePasswordGroup" style="display: none;">
                    <label for="codePasswordInput">Password:</label>
                    <input type="password" id="codePasswordInput" maxlength="20">
                </div>
                <div class="modal-buttons">
                    <button type="submit" class="btn btn-primary">Join</button>
                    <button type="button" id="cancelCodeJoinBtn" class="btn btn-secondary">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- How to Play Modal -->
    <div id="howToPlayModal" class="modal">
        <div class="modal-content how-to-play-content">
            <h2>How to Play</h2>
            <div class="instructions">
                <h3>üéØ Objective</h3>
                <p>Find the imposter among your group! One player is secretly assigned a different card while everyone
                    else sees the same card.</p>

                <h3>üìã Game Flow</h3>
                <ol>
                    <li><strong>Setup:</strong> Create or join a lobby (3-5 players)</li>
                    <li><strong>Role Assignment:</strong> Everyone gets the same card EXCEPT the imposter, who gets a
                        different card</li>
                    <li><strong>3 Rounds of Messaging:</strong> Each player takes turns typing 1-2 words about their
                        card (15 seconds per turn)</li>
                    <li><strong>Voting Phase:</strong> After all rounds, everyone votes for who they think is the
                        imposter (20 seconds)</li>
                </ol>

                <h3>üéÆ Tips</h3>
                <ul>
                    <li><strong>Regular Players:</strong> Be specific enough to prove you have the card, but vague
                        enough to catch the imposter</li>
                    <li><strong>Imposter:</strong> Listen carefully and try to blend in without revealing you have a
                        different card</li>
                </ul>

                <h3>üèÜ Scoring</h3>
                <ul>
                    <li>If imposter is caught: Everyone else gets 1 point</li>
                    <li>If imposter survives: Imposter gets 3 points</li>
                </ul>
            </div>
            <div class="modal-buttons">
                <button type="button" id="closeHowToPlayBtn" class="btn btn-primary">Got it!</button>
            </div>
        </div>
    </div>

    <!-- Lobby Screen -->
    <div id="lobbyScreen" class="screen">
        <div class="container">
            <div class="lobby-header">
                <h2 id="lobbyTitle">Lobby</h2>
                <p id="lobbyCode" class="lobby-code"></p>
            </div>

            <div class="players-section">
                <h3>Players (<span id="playerCount">0</span>/<span id="maxPlayerCount">5</span>)</h3>
                <div id="playersList" class="players-list"></div>
            </div>

            <div class="lobby-actions">
                <button id="startGameBtn" class="btn btn-primary" style="display: none;">Start Game</button>
                <button id="howToPlayLobbyBtn" class="btn btn-info">How to Play</button>
                <button id="leaveLobbyBtn" class="btn btn-secondary">Leave Lobby</button>
            </div>
        </div>
    </div>

    <!-- Game Screen -->
    <div id="gameScreen" class="screen">
        <div class="game-container">
            <!-- Left Sidebar -->
            <div class="game-sidebar">
                <!-- Card Display (Top) -->
                <div class="card-display" id="cardDisplay">
                    <div class="card-container">
                        <img id="cardImage" src="" alt="Card">
                        <p id="cardName" class="card-name"></p>
                    </div>
                </div>

                <div class="imposter-display" id="imposterDisplay" style="display: none;">
                    <div class="imposter-card">
                        <h2>üé≠ YOU ARE THE IMPOSTER</h2>
                        <p>Blend in!</p>
                    </div>
                </div>

                <!-- Players List (Below Card) -->
                <div class="game-players">
                    <h4>Players</h4>
                    <div id="gamePlayersList" class="game-players-list"></div>
                </div>

                <!-- Voting Timer (Shows during voting) -->
                <div id="votingTimer" class="voting-timer" style="display: none;">
                    <p>‚è±Ô∏è Time to vote: <span id="timerSeconds">20</span>s</p>
                </div>
            </div>

            <!-- Right Side - Dual Chat System -->
            <div class="game-chat">
                <div class="game-header">
                    <h3>Round <span id="currentRound">1</span>/3</h3>
                    <div class="turn-info" id="turnInfo">
                        <p id="turnText">Waiting for turn...</p>
                    </div>
                </div>

                <!-- Guess Chat (Vertical, for guesses only) -->
                <div class="guess-chat-section">
                    <div class="guess-chat-header">
                        <h4>üìù Guess Chat</h4>
                        <p class="guess-hint">Turn-based guesses only</p>
                    </div>
                    <div id="guessMessagesList" class="guess-messages-list"></div>

                    <!-- Guess Input (only visible on your turn) -->
                    <div class="guess-input" id="guessInputSection" style="display: none;">
                        <div class="your-turn-indicator">
                            <p>üéØ YOUR TURN! Type 1-2 words about your card</p>
                        </div>
                        <div class="input-row">
                            <input type="text" id="messageInput" maxlength="20" placeholder="Type 1-2 words...">
                            <button id="sendMessageBtn" class="btn btn-primary">Send</button>
                        </div>
                    </div>
                </div>

                <!-- All Chat (always available) -->
                <div class="all-chat-section">
                    <div class="all-chat-header">
                        <h4>üí¨ All Chat</h4>
                        <p class="all-chat-hint">Chat anytime!</p>
                    </div>
                    <div id="allChatList" class="all-chat-list"></div>
                    <div class="all-chat-input">
                        <input type="text" id="allChatInput" maxlength="100" placeholder="Type a message...">
                        <button id="sendAllChatBtn" class="btn btn-secondary">Send</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Game Over Screen -->
    <div id="gameOverScreen" class="screen">
        <div class="container">
            <div id="gameOverContent" class="game-over-content"></div>

            <div class="game-over-card">
                <p class="reveal-text">The card was:</p>
                <div class="reveal-card-container">
                    <img id="revealCardImage" src="" alt="Card">
                    <p id="revealCardName" class="card-name"></p>
                </div>
            </div>

            <div class="final-scores">
                <h3>Scores</h3>
                <div id="finalScoresList"></div>
            </div>

            <p class="returning-text">Returning to lobby in a few seconds...</p>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="client.js"></script>
</body>

</html>